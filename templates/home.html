{% extends 'base.html' %}

{% block content %}

<div class="container">
    <h3 style="padding:10px;font-weight:900;color:#7E1891;text-shadow:5px 5px 10px rgb(181, 19, 173)">All Projects</h3>
    <div class="row" id="projects" style="margin-top:20px;"></div>
</div>




<script>
    load_all_projects()
    function load_all_projects(){
        // alert('hi')
        $.ajax({
        url: "{{ url_for('fetch_all_projects') }}",
        type: "GET",
        success: function (resp) {
            
            // alert(resp);
            console.log('resp', resp);
            if (resp.status) {
                if (resp.data.length > 0) {
                    let html = ``;

                    let colors=['#16C47F','#A6CDC6','#EDF4C2','#C890A7','DF9755','77B254']

                    $.each(resp.data, function (index, project) {
                        console.log('projects', project);
                        desc=truncateText(project.description,15)
                        tit=truncateText(project.title,25)
                        let card_color=colors[index % colors.length] 

                        // Display tags
                        img_path=`${project.cover}`
                        
                        html += `
                                <div class="col-lg-3 col-md-4 col-sm-6 col-12 mb-3">
                                    <div class="card" style="width: 100%;background-color:${card_color};box-shadow:10px 10px 10px #FFC145">
                                        <img src="${img_path}" class="card-img-top" alt="...">
                                        <div class="card-body">
                                            <h5 class="card-title">${tit}</h5>
                                            <p class="card-text">${desc}</p>
                                            <a href="/load_single_project?id=${project.id}" class="btn btn-primary">Learn More</a>
                                        </div>
                                    </div>
                                </div>
                                
                            `;

                        // Add cards data if it exists
                        

                        
                    });

                    // Append the rows to the table
                    $('#projects').html(html);

                    // Reinitialize DataTable if needed
                    
                } else {
                    $('#projects').html(`
                            No Data Found
                        `);
                }
            } else {
                $('#projects').html(`
                    
                        ${resp.message}
                    `);
            }
        },
        error: function (err) {
            console.log(err);
            $('#projects').html(`
                    Error loading data.
               `);
        },
        complete: function () {
            // Optional: Any additional steps after the request is complete.
        }
    });
    }
    function truncateText(text, maxLength) {
        if (text.length > maxLength) {
            return text.substring(0, maxLength) + '...';
        } else {
            return text;
        }
    }
</script>
{% endblock %}
